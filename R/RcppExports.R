# This file was generated by Rcpp::compileAttributes
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Calculate the residual of lm(Y ~ X)
#'
#' @param X matrix
#' @param Y matrix
#' @return The residual matrix
lmresid_llt <- function(X, Y) {
    .Call('qtlpvl_lmresid_llt', PACKAGE = 'qtlpvl', X, Y)
}

lmresid_qr <- function(X, Y) {
    .Call('qtlpvl_lmresid_qr', PACKAGE = 'qtlpvl', X, Y)
}

#' Residual of lm(Y ~ X)
#'
#' An implementation for calculate residual of linear
#' regression. It's ' not as fast as lmresid_llt (about 50% slower),
#' but is rank revealing, so should be safe for linear correlated X.
#'
#' @param X matrix
#' @param Y matrix
#' @param threshold Eigen decomposition is used in calculation. An
#' eigen value smaller than threshold * largest eigen value is
#' considered zero.
#' @return The residual matrix
lmresid_svd <- function(X, Y, threshold = 1e-7) {
    .Call('qtlpvl_lmresid_svd', PACKAGE = 'qtlpvl', X, Y, threshold)
}

lmresid_symmEigen <- function(X, Y, threshold = 1e-7) {
    .Call('qtlpvl_lmresid_symmEigen', PACKAGE = 'qtlpvl', X, Y, threshold)
}

#' Sample covarance matrix of residual for linear model
#'
lmresid_cov <- function(X, Y, threshold = 1e-7) {
    .Call('qtlpvl_lmresid_cov', PACKAGE = 'qtlpvl', X, Y, threshold)
}

#' Determinant of residual for linear model
#'
lmresid_cov_det <- function(X, Y, logarithm = TRUE, threshold = 1e-7) {
    .Call('qtlpvl_lmresid_cov_det', PACKAGE = 'qtlpvl', X, Y, logarithm, threshold)
}

#' Determinant of self cross product
#'
#' Calculate the determinate of X^T X. By using the symmetric property
#' of X^T X, this implementation is much faster than calling the
#' general function `determinant` on crossproduct(X)
#'
#' @param X matrix
#' @param logarithm A bool value indicating whether determinant or
#' log determinate should be returned.
#' @return The determinant or log determinant
det_AtA <- function(X, logarithm = TRUE) {
    .Call('qtlpvl_det_AtA', PACKAGE = 'qtlpvl', X, logarithm)
}

